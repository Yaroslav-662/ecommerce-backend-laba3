Звіт з лабораторної роботи 2
Тема роботи: Аутентифікація, авторизація та розширений функціонал

Здобувач освіти: Поліщук Ярослав
Група: ІПЗ-42
GitHub репозиторій: https://github.com/Yaroslav-662/ecommerce-backend-laba-2
Рівень складності: 3

Реалізований функціонал
Рівень 1

Реєстрація користувачів з валідацією даних

Хешування паролів (bcrypt)

Авторизація через JWT

Middleware для захисту приватних маршрутів

Ролі користувачів (user, admin)

Авторизація доступу до адмін-маршрутів

Пагінація для списків даних

Swagger документація API

Рівень 2

Завантаження файлів (multer)

Обмеження формату та розміру файлів

Пошук та фільтрація даних

Зміна пароля

Скидання пароля через email

Оновлення access токена за refresh token

Тести для базових auth-ендпоінтів

Рівень 3

Підтвердження email після реєстрації

Відновлення пароля через email-токен

Двофакторна аутентифікація (Google Authenticator, QR)

Вхід через Google OAuth

Історія входів

Управління сесіями (перегляд, видалення, logout all)

Розширені права доступу

Розширена документація Swagger

Ключові фрагменти коду
Генерація токенів
export const generateAccessToken = (user) =>
  jwt.sign({ id: user._id, role: user.role }, process.env.JWT_SECRET, {
    expiresIn: "15m",
  });

Надсилання листа для підтвердження email
await sendEmail({
  to: email,
  subject: "Confirm email",
  html: `<a href="${verifyUrl}">Підтвердити акаунт</a>`
});

Двофакторна аутентифікація
const secret = speakeasy.generateSecret({ name: `Ecommerce (${user.email})` });
const qr = await qrcode.toDataURL(secret.otpauth_url);

Reset Password
user.password = await hashPassword(password);
user.resetPasswordToken = undefined;
user.resetPasswordExpires = undefined;
await user.save();

Скріншоти

Swagger документація

Реєстрація (email confirm)

Вхід користувача

2FA QR-код

Перегляд сесій

Google OAuth

Завантаження файлу

Висновки

В ході роботи було повністю реалізовано систему аутентифікації та авторизації з усіма сучасними механізмами безпеки.
Система підтримує email підтвердження, відновлення пароля, двофакторну аутентифікацію, OAuth, керування сесіями, ролі та обмеження доступу.

Робота охоплює всі рівні складності та повністю протестована через Swagger.

Самооцінка: 5 / 5
Обґрунтування:

Реалізовано всі вимоги рівнів 1–3

Додано розширений функціонал (сесії, історія входів)

Код повністю робочий і протестований

Структура API відповідає сучасним вимогам